// ... dentro lo script di form.html ...
const _supabase = supabase.createClient('TUO_URL', 'TUA_KEY');

// Caricamento dati per modifica
async function caricaRecord(id) {
    const { data, error } = await _supabase.from('tickets').select('*').eq('id', id).single();
    if (data) {
        document.getElementById('prodotto-id').value = data.id;
        document.getElementById('nome').value = data.nome;
        document.getElementById('descrizione').value = data.descrizione;
    }
}

// Salvataggio (Insert o Update)
document.getElementById('form-prodotto').addEventListener('submit', async (e) => {
    e.preventDefault();
    const id = document.getElementById('prodotto-id').value;
    const payload = {
        nome: document.getElementById('nome').value,
        descrizione: document.getElementById('descrizione').value
    };

    let res;
    if (id) {
        res = await _supabase.from('tickets').update(payload).eq('id', id);
    } else {
        res = await _supabase.from('tickets').insert([payload]);
    }

    if (res.error) alert("Errore: " + res.error.message);
    else location.href = 'index.html';
});
